# ══════════════════════════════════════════════════════════════════════════════
# VT-HyprNoir Window Rules - Hyprland 0.53+ Syntax
# Updated for CachyOS + NVIDIA RTX 4070 SUPER
# ══════════════════════════════════════════════════════════════════════════════

# ── Floating Windows ──────────────────────────────────────────────────────────
windowrule = float on, match:class ^(org.pulseaudio.pavucontrol)$
windowrule = float on, match:class ^(blueman-manager)$
windowrule = float on, match:class ^(xdg-desktop-portal-gtk|xdg-desktop-portal-kde|xdg-desktop-portal-hyprland)(.*)$
windowrule = float on, match:class ^(polkit-gnome-authentication-agent-1|hyprpolkitagent|org.kde.polkit-kde-authentication-agent-1)(.*)$
windowrule = float on, match:class ^(CachyOSHello)$
windowrule = float on, match:class ^(zenity)$
windowrule = float on, match:class ^(nwg-look|net.lutris.Lutris|edmarketconnector.exe)$
windowrule = float on, match:class ^(org.gnome.Nautilus)$
windowrule = float on, match:class ^(LibreWolf)$, match:title ^(Picture-in-Picture)$
windowrule = float on, match:class ^(nemo)$
windowrule = float on, match:class ^(btrfs-assistant)$
windowrule = float on, match:class ^(yad)$
windowrule = float on, match:class ^(GitHub Desktop)$
windowrule = float on, match:class ^(protonvpn-app)$
windowrule = float on, match:class ^(com.github.wwmm.easyeffects)$

# ── Floating by title ─────────────────────────────────────────────────────────
windowrule = float on, match:title ^(Picture-in-Picture|Save File|Open File|Steam - Self Updater)$

# ── Media players (float + center + size) ─────────────────────────────────────
windowrule {
    name = media-players
    match:title = ^(imv|mpv|danmufloat|termfloat|ncmpcpp)$
    float = on
    center = on
    size = 960 540
}

windowrule = pin on, match:title ^(danmufloat)$
windowrule = rounding 5, match:title ^(danmufloat|termfloat)$

# ── Workspace Rules ───────────────────────────────────────────────────────────
windowrule = workspace 2, match:class ^(steam_app_359320)$
windowrule = workspace 2, match:class ^(steam)$, match:title ^(Steam)$
windowrule = workspace 3, match:class ^(discord)$
windowrule = workspace 4, match:class ^(Proton Mail)$

# ── Tearing Rules for Gaming (NVIDIA RTX 4070 SUPER) ──────────────────────────
windowrule = immediate on, match:class ^(steam_app_)
windowrule = immediate on, match:class ^(cs2|dota2|hl2_linux)$
windowrule = immediate on, match:class ^(gamescope)$
windowrule = immediate on, match:class ^(elite[-_]dangerous)$
windowrule = immediate on, match:title ^(Monster Hunter)
windowrule = immediate on, match:title ^(Cyberpunk 2077)

# ── Floating Style: Waybar Blue ───────────────────────────────────────────────
windowrule = opacity 0.97 0.97, match:floating 1
windowrule = bordercolor rgb(4B7891), match:floating 1
windowrule = rounding 12, match:floating 1
windowrule = bordersize 2, match:floating 1

# ── Opacity Tweaks ────────────────────────────────────────────────────────────
windowrule = opacity 0.99, match:class ^(thunar|nemo)$
windowrule = opacity 0.99, match:class ^(discord|armcord|webcord)$
windowrule = opacity 0.99, match:title ^(QQ|Telegram|NetEase Cloud Music Gtk4)$

# ── Fix Flatpak Opacity ───────────────────────────────────────────────────────
windowrule = opacity 1.0 override, match:class ^(com.discordapp.Discord)$
windowrule = opacity 1.0 override, match:class ^(com.spotify.Client)$
windowrule = opacity 1.0 override, match:class ^(io.github.flattool.Warehouse)$
windowrule = opacity 1.0 override, match:class ^(com\.)(.*)$
windowrule = opacity 1.0 override, match:class ^(org\.)(.*)$
windowrule = opacity 1.0 override, match:class ^(io\.)(.*)$

# ── Picture-in-Picture ────────────────────────────────────────────────────────
windowrule {
    name = pip-windows
    match:title = ^(Picture-in-Picture)$
    float = on
    size = 960 540
    center = on
    pin = on
}

# ── Suppress maximize ─────────────────────────────────────────────────────────
windowrule = suppressevent maximize, match:class .*

# ── Terminal Animation ────────────────────────────────────────────────────────
windowrule = animation slide right, match:class ^(kitty|Alacritty|ghostty)$

# ── Disable Blur for Browsers ─────────────────────────────────────────────────
windowrule = no_blur on, match:class ^(org.mozilla.firefox|brave-browser|librewolf)$

# ── XWayland Drag Fix ─────────────────────────────────────────────────────────
windowrule = no_focus on, match:class ^$, match:title ^$, match:xwayland 1, match:floating 1, match:fullscreen 0, match:pinned 0

# ── Workspace Decorations ─────────────────────────────────────────────────────
windowrule = bordersize 2, match:floating 1, match:onworkspace w[fv1-10]
windowrule = bordercolor rgb(4B7891), match:floating 1, match:onworkspace w[fv1-10]
windowrule = rounding 8, match:floating 1, match:onworkspace w[fv1-10]
windowrule = bordersize 3, match:floating 0, match:onworkspace f[1-10]
windowrule = rounding 4, match:floating 0, match:onworkspace f[1-10]

# ══════════════════════════════════════════════════════════════════════════════
# Layer Rules (0.53+ block syntax)
# ══════════════════════════════════════════════════════════════════════════════

layerrule {
    name = logout-dialog
    match:namespace = ^(logout_dialog)$
    animation = slide top
}

layerrule {
    name = waybar-layer
    match:namespace = ^(waybar)$
    animation = slide down
    blur = true
    ignore_zero = true
}

layerrule {
    name = wallpaper-layer
    match:namespace = ^(wallpaper)$
    animation = fade 50%
}

layerrule {
    name = nwg-dock-blur
    match:namespace = ^(nwg-dock-hyprland|nwg-dock)$
    blur = true
}

layerrule {
    name = dunst-blur
    match:namespace = ^(dunst)$
    blur = true
}
